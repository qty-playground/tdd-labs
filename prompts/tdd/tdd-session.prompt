# TDD Session Controller (Java SE)

## â˜• Java SE TDD Workflow

### ğŸ¯ ç•¶æ”¶åˆ°æ–°éœ€æ±‚æ™‚çš„åæ€æµç¨‹  
**åœ¨é€²å…¥ä»»ä½• TDD éšæ®µå‰ï¼Œå¿…é ˆå…ˆé€²è¡Œéœ€æ±‚åˆ†æ**

#### å¿…è¦åæ€æª¢æŸ¥é»ï¼š
```
â“ åæ€å•é¡Œï¼š
1. é€™å€‹éœ€æ±‚æ˜¯å¦åŒ…å«å¤šå€‹ç¨ç«‹çš„æ¸¬è©¦æ¡ˆä¾‹ï¼Ÿ
2. å¦‚æœæ˜¯ï¼Œæ‡‰è©²æ‹†è§£æˆå¹¾å€‹ TDD cyclesï¼Ÿ
3. æ¯å€‹ cycle è¦æ¸¬è©¦ä»€éº¼å…·é«”çš„æ–¹æ³•ç°½åå’Œè¼¸å…¥â†’è¼¸å‡ºï¼Ÿ

ğŸ“‹ åˆ†æè¼¸å‡ºæ ¼å¼ï¼š
TDD Cycles Planning:
Cycle 1: [æ¸¬è©¦æ–¹æ³•æè¿°] - Input: X, Expected: Y
Cycle 2: [æ¸¬è©¦æ–¹æ³•æè¿°] - Input: X, Expected: Y  
...
ç¸½è¨ˆ: N è¼ª cycles
ç•¶å‰è™•ç†: Cycle 1
```

#### ğŸš¨ éœ€è¦æ‹†è§£çš„éœ€æ±‚è­˜åˆ¥ï¼š
- **å¤šå€‹å…·é«”ç¯„ä¾‹**: "æ•¸å­— 3, 6, 9 éƒ½æ‡‰è©²å›å‚³ Foo" â†’ 3å€‹ test methods
- **ä¸åŒè¦å‰‡çµ„åˆ**: "åŸºæœ¬è¦å‰‡ + Fooè¦å‰‡ + è¤‡åˆè¦å‰‡" â†’ è‡³å°‘3å€‹ test cycles  
- **é‚Šç•Œæ¢ä»¶åˆ—èˆ‰**: "æ­£æ•¸ã€è² æ•¸ã€é›¶çš„è™•ç†" â†’ 3å€‹ test cases

#### âœ… å–®ä¸€æ¡ˆä¾‹çš„éœ€æ±‚ï¼š
- **ä¸€å€‹å…·é«”è¼¸å…¥è¼¸å‡º**: "ç•¶è¼¸å…¥3æ™‚æ‡‰è©²å›å‚³Foo" â†’ 1å€‹ test method
- **å–®ä¸€è¦å‰‡é©—è­‰**: "é©—è­‰emailæ ¼å¼æª¢æŸ¥" â†’ 1å€‹ test cycle

## State Machine Control

```
[Start] â†’ Red â†’ Green â†’ Refactor â†’ Red â†’ ... â†’ [Wait for New Rule]
```

## Current State Detection

### Determine Current Phase
æª¢æŸ¥ç•¶å‰ç‹€æ³ä¾†æ±ºå®šæ‡‰è©²åœ¨å“ªå€‹éšæ®µï¼š

1. **é€²å…¥ Red Phase çš„æ¢ä»¶ï¼š**
   - å·²å®Œæˆéœ€æ±‚åˆ†æï¼Œæ˜ç¢ºæœ¬è¼ªè¦æ¸¬è©¦çš„æ¡ˆä¾‹
   - æº–å‚™é–‹å§‹æŸä¸€å€‹å…·é«”çš„ TDD cycle
   - ä¸Šä¸€å€‹ refactor éšæ®µå®Œæˆï¼Œé€²å…¥ä¸‹ä¸€è¼ª cycle
   - æœ‰æ˜ç¢ºçš„å–®ä¸€æ¸¬è©¦æ¡ˆä¾‹è¦å¯¦ä½œ

2. **é€²å…¥ Green Phase çš„æ¢ä»¶ï¼š**
   - Red phase å®Œæˆï¼ˆæœ‰å¤±æ•—çš„æ¸¬è©¦ï¼‰
   - src/test/java/ ç›®éŒ„ä¸‹æœ‰æ–°çš„å¤±æ•—æ¸¬è©¦
   - éœ€è¦å¯¦ä½œç¨‹å¼ç¢¼è®“æ¸¬è©¦é€šé

3. **é€²å…¥ Refactor Phase çš„æ¢ä»¶ï¼š**
   - Green phase å®Œæˆï¼ˆæ¸¬è©¦é€šéï¼‰
   - æ‰€æœ‰æ¸¬è©¦éƒ½æ˜¯ç¶ è‰²çš„
   - ç¨‹å¼ç¢¼æœ‰æ”¹å–„ç©ºé–“ï¼ˆé‡è¤‡ã€å‘½åã€çµæ§‹ï¼‰

4. **é€²å…¥ Wait State çš„æ¢ä»¶ï¼š**
   - Refactor phase å®Œæˆ
   - æ²’æœ‰æ–°çš„ business rule
   - æ²’æœ‰æ˜é¡¯çš„ç¨‹å¼ç¢¼æ”¹å–„éœ€æ±‚

## Phase Transition Commands

### éœ€æ±‚åˆ†æå’Œè¦åŠƒ
```
ğŸ” REQUIREMENTS ANALYSIS:
1. åˆ†ææ”¶åˆ°çš„éœ€æ±‚æ˜¯å¦åŒ…å«å¤šå€‹æ¸¬è©¦æ¡ˆä¾‹
2. æ‹†è§£æˆç¨ç«‹çš„è¼¸å…¥â†’è¼¸å‡ºæ¡ˆä¾‹
3. è¦åŠƒè¦é€²è¡Œå¹¾è¼ª TDD cycles
4. èšç„¦åˆ°ç¬¬ä¸€å€‹è¦è™•ç†çš„æ¡ˆä¾‹
è¼¸å‡ºï¼šTDD Cycles Planning æ¸…å–®
```

### å•Ÿå‹• Red Phase
```
ç¾åœ¨é€²å…¥ RED PHASE - Cycle X
ä½¿ç”¨ @prompts/tdd/red-phase.prompt
ç›®æ¨™ï¼šç‚ºç•¶å‰ cycle çš„æ¡ˆä¾‹å¯«å¤±æ•—çš„ JUnit æ¸¬è©¦
ç•¶å‰æ¡ˆä¾‹ï¼š[å…·é«”è¼¸å…¥] â†’ [é æœŸè¼¸å‡º]
åŸ·è¡Œï¼š./mvnw test æˆ– ./gradlew testï¼ˆå„ªå…ˆä½¿ç”¨ wrapperï¼‰ç¢ºèªæ¸¬è©¦å¤±æ•—
```

### å•Ÿå‹• Green Phase  
```
ç¾åœ¨é€²å…¥ GREEN PHASE
ä½¿ç”¨ @prompts/tdd/green-phase.prompt  
ç›®æ¨™ï¼šæœ€ç°¡å¯¦ä½œè®“ JUnit æ¸¬è©¦é€šé
åŸ·è¡Œï¼š./mvnw test æˆ– ./gradlew testï¼ˆå„ªå…ˆä½¿ç”¨ wrapperï¼‰ç¢ºèªæ¸¬è©¦é€šé
```

### å•Ÿå‹• Refactor Phase
```
ç¾åœ¨é€²å…¥ REFACTOR PHASE
ä½¿ç”¨ @prompts/tdd/refactor-phase.prompt
ç›®æ¨™ï¼šæ”¹å–„ç¨‹å¼ç¢¼å“è³ªï¼Œä¿æŒ JUnit æ¸¬è©¦é€šé
åŸ·è¡Œï¼š./mvnw test æˆ– ./gradlew testï¼ˆå„ªå…ˆä½¿ç”¨ wrapperï¼‰é »ç¹ç¢ºèªæ¸¬è©¦ä»é€šé
```

### ç­‰å¾…æ–°è¦å‰‡
```
TDD CYCLE COMPLETE
ç­‰å¾…æ–°çš„ business rule æˆ–å•é¡Œæ¢ç´¢
æº–å‚™é€²å…¥ä¸‹ä¸€å€‹ Red Phase
```

## Session Management

### ç•¶å‰æœƒè©±ç‹€æ…‹
- Main Class: `src/main/java/com/example/ExampleService.java`
- Test Class: `src/test/java/com/example/ExampleServiceTest.java`  
- Current Phase: `[PLANNING|RED|GREEN|REFACTOR|WAITING]`
- Current Cycle: `Cycle X / Total Y cycles`
- Current Test Case: `å…·é«”çš„è¼¸å…¥ â†’ é æœŸè¼¸å‡º`
- Remaining Cases: `å‰©é¤˜è¦è™•ç†çš„æ¡ˆä¾‹åˆ—è¡¨`
- Build Tool: `[Maven|Gradle]`
- Java Version: `Java 8+ recommended`

### Phase Completion Checklist
- [ ] Planning: éœ€æ±‚å·²åˆ†æï¼Œcycles å·²è¦åŠƒ
- [ ] Red: æ¸¬è©¦å¯«å®Œä¸”å¤±æ•— (ç•¶å‰ cycle)
- [ ] Green: æ¸¬è©¦é€šéï¼ŒåŠŸèƒ½å¯¦ä½œ (ç•¶å‰ cycle)
- [ ] Refactor: ç¨‹å¼ç¢¼æ”¹å–„ï¼Œæ¸¬è©¦ä»é€šé (ç•¶å‰ cycle)
- [ ] Cycle Complete: ç•¶å‰ cycle å®Œæˆï¼Œæª¢æŸ¥æ˜¯å¦æœ‰ä¸‹ä¸€å€‹
- [ ] Session: æ‰€æœ‰ cycles å®Œæˆï¼Œæº–å‚™æ¥å—æ–°çš„ business rule

## State Transition Rules

1. **éœ€æ±‚åˆ†æå„ªå…ˆ**: æ”¶åˆ°éœ€æ±‚ â†’ å…ˆåˆ†ææ‹†è§£ â†’ å†é€²å…¥ TDD
2. **åš´æ ¼é †åº**: Red â†’ Green â†’ Refactor (for each cycle)
3. **ä¸å¯è·³é**: æ¯å€‹éšæ®µéƒ½å¿…é ˆå®Œæˆ
4. **å–®ä¸€è·è²¬**: æ¯å€‹éšæ®µåªåšè©²éšæ®µçš„äº‹  
5. **æ–‡ä»¶ç´„æŸ**: åš´æ ¼éµå®ˆæª”æ¡ˆä¿®æ”¹é™åˆ¶
6. **å®Œæˆç¢ºèª**: æ¯å€‹éšæ®µçµæŸå‰ç¢ºèªç›®æ¨™é”æˆ
7. **å¾ªç’°ç®¡ç†**: å®Œæˆä¸€è¼ªå¾Œï¼Œæª¢æŸ¥æ˜¯å¦æœ‰ä¸‹ä¸€å€‹æ¡ˆä¾‹è¦è™•ç†

## â˜• Java SE Specific Guidelines

### å°ˆæ¡ˆçµæ§‹ (Maven Standard)
```
project-root/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main/java/
â”‚   â”‚   â””â”€â”€ com/example/
â”‚   â”‚       â””â”€â”€ YourClass.java
â”‚   â””â”€â”€ test/java/
â”‚       â””â”€â”€ com/example/
â”‚           â””â”€â”€ YourClassTest.java
â”œâ”€â”€ pom.xml (Maven) æˆ– build.gradle (Gradle)
â””â”€â”€ README.md
```

### æ¸¬è©¦æ¡†æ¶é¸æ“‡
- **JUnit 5** (æ¨è–¦): `@Test`, `assertEquals()`, `assertThrows()`
- **JUnit 4** (å…¼å®¹): `@Test`, `Assert.assertEquals()`
- **TestNG** (æ›¿ä»£): `@Test`, `Assert.assertEquals()`

### å»ºè­°ä¾è³´è¨­å®š (Maven pom.xml)
```xml
<dependencies>
    <dependency>
        <groupId>org.junit.jupiter</groupId>
        <artifactId>junit-jupiter</artifactId>
        <version>5.9.2</version>
        <scope>test</scope>
    </dependency>
</dependencies>
```

### å¸¸ç”¨æ¸¬è©¦å‘½ä»¤ï¼ˆå„ªå…ˆä½¿ç”¨ wrapperï¼‰
```bash
# Maven - å„ªå…ˆä½¿ç”¨ wrapper
./mvnw test                    # åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦ï¼ˆå¦‚æœæœ‰ mvnwï¼‰
./mvnw test -Dtest=ClassName   # åŸ·è¡Œç‰¹å®šæ¸¬è©¦é¡
./mvnw compile                 # ç·¨è­¯ä¸»ç¨‹å¼ç¢¼
./mvnw clean compile          # æ¸…ç†å¾Œé‡æ–°ç·¨è­¯

# å¦‚æœæ²’æœ‰ wrapperï¼Œfallback åˆ°ï¼š
mvn test
mvn test -Dtest=ClassName
mvn compile
mvn clean compile

# Gradle - å„ªå…ˆä½¿ç”¨ wrapper
./gradlew test                 # åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦ï¼ˆå¦‚æœæœ‰ gradlewï¼‰
./gradlew test --tests ClassName  # åŸ·è¡Œç‰¹å®šæ¸¬è©¦é¡
./gradlew compileJava         # ç·¨è­¯ä¸»ç¨‹å¼ç¢¼
./gradlew clean build         # æ¸…ç†å¾Œé‡æ–°æ§‹å»º

# å¦‚æœæ²’æœ‰ wrapperï¼Œfallback åˆ°ï¼š
gradle test
gradle test --tests ClassName
gradle compileJava
gradle clean build
```

### Java TDD æœ€ä½³å¯¦è¸
1. **æ¸¬è©¦æ–¹æ³•å‘½å**: `should_ReturnExpected_When_GivenInput()`
2. **æ¸¬è©¦é¡å‘½å**: `ClassNameTest` æˆ– `ClassNameTests`
3. **ä¸€å€‹æ¸¬è©¦ä¸€å€‹æ–·è¨€**: ä¿æŒæ¸¬è©¦ç°¡æ½”æ˜ç¢º
4. **ä½¿ç”¨ AAA æ¨¡å¼**: Arrange â†’ Act â†’ Assert
5. **é©ç•¶ä½¿ç”¨ @BeforeEach** å’Œ **@AfterEach** é€²è¡Œsetup/cleanup

### ç¯„ä¾‹æ¸¬è©¦æ¨¡æ¿ (JUnit 5)
```java
import org.junit.jupiter.api.Test;
import static org.junit.jupiter.api.Assertions.*;

class ExampleServiceTest {
    
    @Test
    void should_ReturnExpected_When_GivenInput() {
        // Arrange
        ExampleService service = new ExampleService();
        int input = 3;
        String expected = "Foo";
        
        // Act
        String actual = service.process(input);
        
        // Assert
        assertEquals(expected, actual);
    }
}
```