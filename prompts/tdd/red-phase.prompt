# RED PHASE - Write Failing Tests

## ğŸ”´ RED PHASE ACTIVE

**ç›®æ¨™ï¼šç‚ºæ–°çš„ business rule å¯«ä¸€å€‹å¤±æ•—çš„æ¸¬è©¦**

## Strict File Modification Rules

### âœ… ALLOWED - åªèƒ½ä¿®æ”¹é€™äº›æª”æ¡ˆï¼š
- `tests/` ç›®éŒ„ä¸‹çš„ä»»ä½• `*_test.py` æª”æ¡ˆ
- æ–°å¢ test imports å’Œ test utilities
- ä¿®æ”¹ test fixtures å’Œ test data

### âŒ FORBIDDEN - çµ•å°ä¸å¯ä¿®æ”¹ï¼š
- `tdd_labs/` ç›®éŒ„ä¸‹çš„ä»»ä½•å¯¦ä½œæª”æ¡ˆ
- `main.py`, `__init__.py` ç­‰å¯¦ä½œç›¸é—œæª”æ¡ˆ  
- ä»»ä½•éæ¸¬è©¦çš„ç¨‹å¼ç¢¼

## Red Phase Objectives

### 1. Write One Failing Test
```python
def test_should_capture_new_business_rule():
    """æ¸¬è©¦åç¨±è¦æ¸…æ¥šæè¿° business rule"""
    # Arrange - æº–å‚™æ¸¬è©¦è³‡æ–™
    service = TargetService()
    
    # Act & Assert - åŸ·è¡Œä¸¦é©—è­‰é æœŸå¤±æ•—
    with pytest.raises(NotImplementedError):
        service.new_business_rule_method()
```

### 2. Test Quality Requirements
- **Descriptive Names**: æ¸¬è©¦åç¨±è¦èªªæ˜ business rule
  - âœ… `test_should_reject_invalid_email_format`
  - âœ… `test_should_require_minimum_password_length`
  - âŒ `test_validation`
  - âŒ `test_user`
- **Single Rule**: ä¸€å€‹æ¸¬è©¦åªé©—è­‰ä¸€å€‹è¦å‰‡
- **Clear Intent**: æ˜ç¢ºè¡¨é”é æœŸè¡Œç‚º
- **Minimal Setup**: æœ€å°‘çš„æ¸¬è©¦è¨­ç½®

### 3. Expected Failure Types
```python
# Method not implemented yet
with pytest.raises(NotImplementedError):
    service.method_name()

# Class doesn't exist yet  
from tdd_labs.services.new_service import NewService  # ImportError expected

# Validation rule not implemented
with pytest.raises(ValidationError):
    service.validate("invalid_input")

# API endpoint not implemented (using test_client fixture)
def test_should_return_user_profile(test_client):
    response = test_client.get("/profile")
    # Expected: 404 or 501 - endpoint not implemented yet

# Authentication required (using authenticated_client fixture)  
def test_should_require_valid_token(authenticated_client):
    response = authenticated_client.get("/admin/users")
    # Expected: 403 or NotImplementedError - authorization logic not implemented
```

## Red Phase Completion Criteria

### âœ… Phase Complete When:
1. **Test is written** - æ–°æ¸¬è©¦å·²å¯«å®Œ
2. **Test runs and fails** - åŸ·è¡Œ `pytest -v` ç¢ºèªæ¸¬è©¦è¢«ç™¼ç¾ä¸”å¤±æ•—
3. **Test fails correctly** - æ¸¬è©¦å› ç‚ºæ­£ç¢ºçš„åŸå› å¤±æ•—ï¼ˆNotImplementedError, ImportError, etcï¼‰
4. **Test is focused** - åªæ¸¬è©¦ä¸€å€‹ business rule
5. **Imports are minimal** - åª import å¿…è¦çš„æ±è¥¿

### ğŸ“‹ Red Phase Checklist:
- [ ] æ¸¬è©¦å¯«åœ¨æ­£ç¢ºçš„ `tests/` ç›®éŒ„ä¸‹
- [ ] æ¸¬è©¦åç¨±æ¸…æ¥šæè¿° business rule
- [ ] åŸ·è¡Œ `pytest -v` ç¢ºèªæ¸¬è©¦è¢«ç™¼ç¾ä¸”æœƒå¤±æ•—ï¼ˆåŸå› æ­£ç¢ºï¼‰
- [ ] æ²’æœ‰ä¿®æ”¹ä»»ä½•å¯¦ä½œç¨‹å¼ç¢¼
- [ ] æº–å‚™å¥½é€²å…¥ Green Phase

## Transition to Green Phase

Red Phase å®Œæˆå¾Œï¼Œè¼¸å‡ºï¼š
```
ğŸ”´ â†’ ğŸŸ¢ RED PHASE COMPLETE
Failed test created: [test_method_name]
Reason for failure: [NotImplementedError/ImportError/etc]
Ready for GREEN PHASE
```

## Test Discovery Guidelines

### ç¢ºä¿æ¸¬è©¦è¢« pytest ç™¼ç¾ï¼š
```bash
# æª¢æŸ¥æ¸¬è©¦ç™¼ç¾æƒ…æ³
pytest --collect-only

# æª¢æŸ¥ç‰¹å®šæ¸¬è©¦æª”æ¡ˆ
pytest --collect-only tests/services/user_service_test.py

# å¦‚æœæ¸¬è©¦æ²’è¢«ç™¼ç¾ï¼Œæª¢æŸ¥ï¼š
# 1. æª”æ¡ˆåç¨±æ˜¯å¦ç¬¦åˆ *_test.py æˆ– test_*.py
# 2. å‡½æ•¸åç¨±æ˜¯å¦ä»¥ test_ é–‹é ­
# 3. æª”æ¡ˆè·¯å¾‘æ˜¯å¦åœ¨ tests/ ç›®éŒ„ä¸‹
# 4. æ˜¯å¦æœ‰èªæ³•éŒ¯èª¤é˜»æ­¢ import
```

## Common Red Phase Mistakes to Avoid

âŒ **Don't**:
- ä¿®æ”¹å¯¦ä½œç¨‹å¼ç¢¼
- å¯«å¤šå€‹è¦å‰‡åœ¨ä¸€å€‹æ¸¬è©¦è£¡
- è®“æ¸¬è©¦æ„å¤–é€šé
- éåº¦è¤‡é›œçš„æ¸¬è©¦è¨­ç½®
- å¿˜è¨˜ç¢ºèªæ¸¬è©¦è¢« pytest ç™¼ç¾

âœ… **Do**:
- å°ˆæ³¨å¯«ä¸€å€‹å¤±æ•—æ¸¬è©¦
- æ¸…æ¥šè¡¨é” business rule
- ç¢ºèªå¤±æ•—åŸå› æ­£ç¢º
- ä¿æŒæ¸¬è©¦ç°¡å–®æ˜ç¢º
- å…ˆç¢ºèª test discovery æ­£å¸¸